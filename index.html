<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>The Simple</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="generator" content="Jekyll" />
    <meta name="author" content="John" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="http://zhaoxuan.github.io/css/style.css" type="text/css" />
    <link rel="stylesheet" href="http://zhaoxuan.github.io/css/syntax.css" type="text/css" />
    <link rel="alternate" type="application/atom+xml" title="Recent Entries" href="/atom.xml" />
    <link rel="shortcut icon" href="http://zhaoxuan.github.io/favicon.ico" type="image/x-icon" />
    <!--[if lt IE 9]>
    <script src="http://zhaoxuan.github.io/js/html5.js" type="text/javascript"></script>
    <![endif]-->
</head>
<body id="default">
<div id="head-line"></div>
<div id="content">
    <header id="head">
        <div id="logo">
            <!-- <img src="http://mmistakes.github.io/minimal-mistakes/images/bio-photo.jpg" class="bio-photo" alt=" bio photo"> -->
            <img src="http://zhaoxuan.github.io/images/head_portrait.png" class="bio-photo" alt=" bio photo">
            <h2>Simple</h2>
        </div>
        <nav id="nav">
            <ul>
                <li class="fn-clear"><a href="http://zhaoxuan.github.io" rel="nofollow" class="action"><i class="icon-home"></i> Home</a></li>
                <li class="fn-clear"><a href="http://zhaoxuan.github.io/archives.html"><i class="icon-list-ul"></i> Archives</a></li>
                <li class="fn-clear"><a href="http://zhaoxuan.github.io/contact.html"><i class="icon-envelope-alt"></i> Contact</a></li>
                <li class="fn-clear"><a href="http://www.twitter.com/piznlin"><i class="icon-twitter"></i> Twitter</a></li>
            </ul>
        </nav>
    </header>
    <section id="contain">
        <header id="begin">
            <span>Entities should not be multiplied unnecessarily</span>
        </header>
		
	<article class="post fn-clear">
        <h2 class="post-title"><a href="http://zhaoxuan.github.io/sublime/2013/12/30/the-best-plugin-in-sublime.html" title="The Best Plugin in Sublime Text" rel="bookmark">The Best Plugin in Sublime Text</a></h2>
        <p class="time"><time pubdate="2013-12-30 23:20:00 +0800">30 Dec 2013</time></p>
        
        <p>这是我用过 Sublime 最好用的插件，没有之一。</p>

<p>CodeIntel 可以使一个简单的文本编辑器变成一个强大的 IDE。</p>

<h3>Installing</h3>

<p>With the Package Control plugin: The easiest way to install SublimeCodeIntel is through Package Control, which can be found at this site: <a href="http://wbond.net/sublime_packages/package_control" target="_blank">Package Control</a></p>

<p>Once you install Package Control, restart Sublime Text and bring up the Command Palette (Command+Shift+P on OS X, Control+Shift+P on Linux/Windows). Select &quot;Package Control: Install Package&quot;, wait while Package Control fetches the latest package list, then select SublimeCodeIntel when the list appears. The advantage of using this method is that Package Control will automatically keep SublimeCodeIntel up to date with the latest version.</p>

<h3>Configuring</h3>

<p>For adding additional library paths (django and extra libs paths for Python or extra paths to look for .js files for JavaScript for example), either add those paths as folders to your project, or create an optional codeintel configuration file in your home or in your project&#39;s root.</p>

<p>Configuration files (~/.codeintel/config or project_root/.codeintel/config). All configurations are optional.</p>

<p>This is my configuration file:</p>

<div class="highlight"><pre><code class="bash"><span class="o">{</span>
  <span class="s2">&quot;Python&quot;</span>: <span class="o">{</span>
    <span class="s2">&quot;python&quot;</span>: <span class="s1">&#39;/usr/bin/python&#39;</span>,
    <span class="s2">&quot;pythonExtraPaths&quot;</span>: <span class="o">[</span><span class="s2">&quot;/Library/Python/2.7/site-packages&quot;</span><span class="o">]</span>
  <span class="o">}</span>,

  <span class="s2">&quot;Ruby&quot;</span>: <span class="o">{</span>
    <span class="s2">&quot;ruby&quot;</span>: <span class="s2">&quot;~/.rvm/bin/default_ruby&quot;</span>,
    <span class="s2">&quot;rubyExtraPaths&quot;</span>:<span class="o">[</span><span class="s2">&quot;~/.rvm/gems/ruby-1.9.3-p448@r9/bin&quot;</span><span class="o">]</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>

        
    </article>

	<article class="post fn-clear">
        <h2 class="post-title"><a href="http://zhaoxuan.github.io/ruby/2013/09/30/create-new-jekyll-posts-rake-task.html" title="create new jekyll posts rake task " rel="bookmark">create new jekyll posts rake task </a></h2>
        <p class="time"><time pubdate="2013-09-30 16:03:00 +0800">30 Sep 2013</time></p>
        
        <p>Jekyll, a static site generator, is blog-aware. That means it tracks posts and publication dates. Working with such files can be tricky, but here is one way of using Rake to ease the pain.</p>

<h4>What we need</h4>

<p>Jekyll requires blog posts to be saved in files with a specific filename. It should include the title of the post and the publication date. Example: 2009-06-15-hello-world.markdown. The extension tells Jekyll what text filter to use (Markdown in this case).</p>

<h4>What we want</h4>

<p>Manually typing filenames in the form yyyy-mm-dd-title.filter is a pain. I want to be able to create a post, given a title, and let it figure out the date itself.</p>

<h4>What we get</h4>

<p>I use the following Rake task to create post files:</p>

<div class="highlight"><pre><code class="ruby"><span class="n">desc</span> <span class="s1">&#39;create a new draft post&#39;</span>
<span class="n">task</span> <span class="ss">:post</span><span class="p">,</span> <span class="ss">:title</span> <span class="k">do</span> <span class="o">|</span><span class="n">t</span><span class="p">,</span> <span class="n">args</span><span class="o">|</span>
  <span class="n">title</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">title</span>
  <span class="n">slug</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="no">Date</span><span class="o">.</span><span class="n">today</span><span class="si">}</span><span class="s2">-</span><span class="si">#{</span><span class="n">title</span><span class="o">.</span><span class="n">downcase</span><span class="o">.</span><span class="n">gsub</span><span class="p">(</span><span class="sr">/[^\w]+/</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>

  <span class="n">file</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
    <span class="no">File</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">__FILE__</span><span class="p">),</span>
    <span class="s1">&#39;_posts&#39;</span><span class="p">,</span>
    <span class="n">slug</span> <span class="o">+</span> <span class="s1">&#39;.markdown&#39;</span>
  <span class="p">)</span>

  <span class="k">if</span> <span class="no">File</span><span class="o">.</span><span class="n">exist?</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
    <span class="nb">abort</span><span class="p">(</span><span class="s2">&quot;rake aborted!</span><span class="se">\n</span><span class="s2"> </span><span class="si">#{</span><span class="n">file</span><span class="si">}</span><span class="s2"> already exists.&quot;</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="no">File</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span>
    <span class="n">f</span> <span class="o">&lt;&lt;</span> <span class="o">&lt;&lt;-</span><span class="no">EOS</span>
<span class="sh">---</span>
<span class="sh">layout: post</span>
<span class="sh">title: &quot;#{title}&quot;</span>
<span class="sh">date: #{Time.now.strftime(&#39;%Y-%m-%d %H:%M&#39;)}</span>
<span class="sh">comments: true</span>
<span class="sh">categories:</span>
<span class="sh">---</span>
<span class="no">EOS</span>
  <span class="k">end</span>
  <span class="nb">puts</span> <span class="s2">&quot;Creating new page: </span><span class="si">#{</span><span class="n">file</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="k">end</span>
</code></pre></div>

<p>Now I can type rake post TITLE=&#39;hello, world&#39; to create a post. Here’s what it does:</p>

<p>At lines 3 and 2 it finds the TITLE argument and converts it to a suitable filename with the current date prepended.
At line 6 the filename is expanded to a full path to the file to create.
The following block (8–18) writes a post template to that file. This is some YAML front matter, with the published flag down by default.
Finally, at line 20, it launches the file in my default text editor, which in my case in TextMate.</p>

<h4>Draft posts</h4>

<p>With the published flag set to false I can keep my drafts in my Git repository without actually publishing them. I can find all draft posts using rake drafts:</p>

<div class="highlight"><pre><code class="ruby"><span class="n">desc</span> <span class="s1">&#39;List all draft posts&#39;</span>
<span class="n">task</span> <span class="ss">:drafts</span> <span class="k">do</span>
  <span class="nb">puts</span> <span class="sb">`find ./_posts -type f -exec grep -H &#39;published: false&#39; {} </span><span class="se">\\</span><span class="sb">;`</span>
<span class="k">end</span>
</code></pre></div>

<h4>Renaming files</h4>

<p>One slight problem occurs when I want to rename the file to publish it on a different date. I don’t have a task yet that can easily rename a file. It would also be useful to be able to override the default extension.</p>

<p>There’s still some work to do, but I guess I’ve got 80% of the scenarios covered.</p>

        
    </article>

	<article class="post fn-clear">
        <h2 class="post-title"><a href="http://zhaoxuan.github.io/ruby/2013/09/25/ruby-robust.html" title="提高 ruby script 的健壮性" rel="bookmark">提高 ruby script 的健壮性</a></h2>
        <p class="time"><time pubdate="2013-09-25 10:49:00 +0800">25 Sep 2013</time></p>
        
        <p>首先必须承认 ruby 脚本确实是一个非常好用的工具。</p>

<p>但是我们习惯了一个 script 解决所有的问题，比如</p>

<div class="highlight"><pre><code class="ruby"><span class="c1"># main.rb</span>
<span class="nb">require</span> <span class="s1">&#39;rubygems&#39;</span>

<span class="nb">system</span> <span class="s1">&#39;rm -fr /tmp&#39;</span>
</code></pre></div>

<p>Soooooooo simple。</p>

<p>但是上面的文件，在其他项目里面被 <code>require &#39;main&#39;</code> 会有什么后果?</p>

<p>代码就直接被执行了，后果可大可小，如果是 <code>system &#39;sudo rm -fr /&#39;</code>。</p>

<p>从 python 借鉴了点东西，所有的代码还是放到 <code>def main(); end</code> 里面执行比较安全。</p>

<div class="highlight"><pre><code class="ruby"><span class="c1"># main.rb</span>
<span class="k">def</span> <span class="nf">main</span>
  <span class="k">do</span> <span class="n">some</span> <span class="n">code</span>
<span class="k">end</span>

<span class="k">if</span> <span class="vg">$0</span> <span class="o">==</span> <span class="bp">__FILE__</span>
  <span class="n">main</span>
<span class="k">end</span>
</code></pre></div>

<p>在判断下当前程序是脚本还是被 <code>require</code> 的。</p>

        
    </article>

	<article class="post fn-clear">
        <h2 class="post-title"><a href="http://zhaoxuan.github.io/linux/2013/02/22/my-bash-profile.html" title="我的 bash_profile" rel="bookmark">我的 bash_profile</a></h2>
        <p class="time"><time pubdate="2013-02-22 15:56:00 +0800">22 Feb 2013</time></p>
        
        <h3>习惯</h3>

<p>对于我这样才接触 git 的人，总是有一个不好的习惯，就是不看 branch 就修改提交，因为原来使用 svn 根本没有分支这个概念。</p>

<h3>配置 .bash_profile</h3>

<div class="highlight"><pre><code class="bash"><span class="c"># show git branch</span>
<span class="k">function </span>git_branch <span class="o">{</span>
    <span class="nv">ref</span><span class="o">=</span><span class="k">$(</span>git symbolic-ref HEAD 2&gt; /dev/null<span class="k">)</span> <span class="o">||</span> <span class="k">return</span>;
    <span class="nb">echo</span> <span class="s2">&quot;(&quot;</span><span class="k">${</span><span class="nv">ref</span><span class="p">#refs/heads/</span><span class="k">}</span><span class="s2">&quot;) &quot;</span>;
<span class="o">}</span>

<span class="c"># show ruby version</span>
<span class="k">function </span>ruby_v<span class="o">(){</span>
    <span class="nv">ref</span><span class="o">=</span><span class="k">$(</span>ruby -v|cut -c 1-10<span class="k">)</span><span class="o">||</span><span class="k">return</span>;
    <span class="nb">echo</span> <span class="s2">&quot;(&quot;</span><span class="k">${</span><span class="nv">ref</span><span class="k">}</span><span class="s2">&quot;) &quot;</span>;
<span class="o">}</span>

<span class="c"># PS1</span>
<span class="nb">export </span><span class="nv">PS1</span><span class="o">=</span><span class="s2">&quot;\[\033[01;33m\]\u@\h \[\033[1;32m\]\$(git_branch)$(ruby_v)\[\033[01;31m\]\W\$\[\033[00m\] &quot;</span>
</code></pre></div>

<p>两个方法一个是显示 git branch 分支，一个是显示 ruby version，因为使用 rvm 所以就写了这两个。</p>

        
    </article>

	<article class="post fn-clear">
        <h2 class="post-title"><a href="http://zhaoxuan.github.io/feeling/2013/01/31/hadoop-install.html" title="hadoop install" rel="bookmark">hadoop install</a></h2>
        <p class="time"><time pubdate="2013-01-31 13:43:00 +0800">31 Jan 2013</time></p>
        
        <h4>一 软件安装环境</h4>

<blockquote>
<p>1、 OS：ubuntu-12.10</p>

<p>2、 JDK：jdk1.7.0_07</p>

<p>3、 Hadoop：hadoop-1.0.4</p>

<p>4、 ssh ssh-server</p>
</blockquote>

<p>安装的方法就自己去 google 搜索吧，这里就不啰嗦了。</p>

<h4>二 配置 ssh</h4>

<p>现在确认能否不输入口令就用ssh登录localhost:</p>

<div class="highlight"><pre><code class="bash"><span class="nv">$ </span>ssh localhost
</code></pre></div>

<p>如果不输入口令就无法用ssh登陆localhost，执行下面的命令：</p>

<div class="highlight"><pre><code class="bash"><span class="nv">$ </span>ssh-keygen -t dsa -P <span class="s1">&#39;&#39;</span> -f ~/.ssh/id_dsa 
<span class="nv">$ </span>cat ~/.ssh/id_dsa.pub &gt;&gt; ~/.ssh/authorized_keys
</code></pre></div>

<h4>三、安装 hadoop</h4>

<p>1、下载 hadoop 解压的任意目录</p>

<p>2、修改 hadoop<em>path/confi/hadoop</em>env.sh</p>

<div class="highlight"><pre><code class="bash"><span class="nb">export </span><span class="nv">JAVA_HOME</span><span class="o">=</span>path_to_java
<span class="nb">export </span><span class="nv">HADOOP_INSTALL</span><span class="o">=</span>path_to_hadoop
<span class="nb">export </span><span class="nv">PATH</span><span class="o">=</span><span class="nv">$PATH</span>:<span class="nv">$HADOOP_INSTALL</span>/bin
</code></pre></div>

<h4>四、配置 hadoop</h4>

<p>这里看你是用什么方式启动，我这里是使用 单机伪分布式，使用三个文件 core-site.xml, mapred-site.xml and hdfs-site.xml</p>

<h4>五、格式分布式文件</h4>

<div class="highlight"><pre><code class="bash"><span class="nv">$ </span>bin/hadoop namenode -format
</code></pre></div>

<h4>六、启动Hadoop守护进程：</h4>

<div class="highlight"><pre><code class="bash"><span class="nv">$ </span>bin/start-all.sh
</code></pre></div>

<p>Hadoop守护进程的日志写入到 ${HADOOP<em>LOG</em>DIR} 目录 (默认是 ${HADOOP_HOME}/logs).
浏览NameNode和JobTracker的网络接口，它们的地址默认为：</p>

<p><code>NameNode - http://localhost:50070/</code></p>

<p><code>JobTracker - http://localhost:50030/</code></p>

<p>将输入文件拷贝到分布式文件系统:</p>

<div class="highlight"><pre><code class="bash"><span class="nv">$ </span>bin/hadoop fs -put conf input
</code></pre></div>

<p>运行发行版提供的示例程序：</p>

<div class="highlight"><pre><code class="bash"><span class="nv">$ </span>bin/hadoop jar hadoop-*-examples.jar grep input output <span class="s1">&#39;dfs[a-z.]+&#39;</span>
</code></pre></div>

<p>查看输出文件：
将输出文件从分布式文件系统拷贝到本地文件系统查看：</p>

<div class="highlight"><pre><code class="bash"><span class="nv">$ </span>bin/hadoop fs -get output output 
<span class="nv">$ </span>cat output/*
</code></pre></div>

<p>或者
在分布式文件系统上查看输出文件：</p>

<div class="highlight"><pre><code class="bash"><span class="nv">$ </span>bin/hadoop fs -cat output/*
</code></pre></div>

<p>完成全部操作后，停止守护进程：</p>

<div class="highlight"><pre><code class="bash"><span class="nv">$ </span>bin/stop-all.sh
</code></pre></div>

        
    </article>


    <nav id="pagination" class="fn-clear">
        <ul class="pagination">
            
                
                    <li class="current"><a href="javascript:void(0);">1</a></li>
                
            
                
                    <li><a href="http://zhaoxuan.github.io/page2/">2</a></li>
                
            
                
                    <li><a href="http://zhaoxuan.github.io/page3/">3</a></li>
                
            
                
                    <li><a href="http://zhaoxuan.github.io/page4/">4</a></li>
                
            
                
                    <li><a href="http://zhaoxuan.github.io/page5/">5</a></li>
                
            
                
                    <li><a href="http://zhaoxuan.github.io/page6/">6</a></li>
                
            
                
                    <li><a href="http://zhaoxuan.github.io/page7/">7</a></li>
                
            
        </ul>
    </nav>
	

        <footer id="foot">
            <p>&copy; 2014 John Zhao All rights reserved. Powered by <a href="http://jekyllrb.com">Jekyll</a> using the <a href="http://mademistakes.com/">PIZn</a></p>
        </footer>
    </section>
</div>
<div id="foot-line"></div>
<script src="http://zhaoxuan.github.io/js/jquery.js" type="text/javascript"></script>
<script src="http://zhaoxuan.github.io/js/jquery.scrollTo.js" type="text/javascript"></script>
<script src="http://zhaoxuan.github.io/js/theOne.js" type="text/javascript"></script>

</body>
</html>
